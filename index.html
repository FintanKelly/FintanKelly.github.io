<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Structure Definitions -->
	<title>Fintan Kelly Tutorials</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="images/icon/heart-512.png"/>
	<link rel="icon" href="images/icon/heart-512.png"/>

	<!-- Bootstrap Imports -->
	<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
	<script src="jquery/jquery-3.3.1.min.js"></script>
	<script src="bootstrap/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="highlightjs/styles/atelier-plateau-dark.css">
	<script src="highlightjs/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

	<!-- Personal Imports -->
	<link rel="stylesheet" href="style.css">
	<script src="javascript.js"></script>
</head>
<body>

<!-- Navigation Bar (Horizontal 100% Width, Z-Index: 9999) -->
<div id="navbar">
</div>

<script>
$(function(){
  $("#navbar").load("navbar.html");
});
</script>

<br></br><br></br>

<!-- I give each section the 'toggle' class so I can use javascript to hide and unhide them. -->
<section class="toggle" id="home">
	<div class="container text-center">
		<p class="display-4">Welcome!</p>
		<p class="display-4">Choose a section in the top left navigation bar.</p>
	</div>
</section>

<section class="toggle" style="display:none;" id="about">
	<div class="container text-center">
		<img src="images/about/me.png" class="img-fluid w-25 h-25" alt="Icon">
		<br></br>
		<p>Hello! I'm Fintan Kelly, and this tiny website houses some of the tutorials I've made on various programming languages, applications, games, etc.</p>
		<p>Hopefully you can find something that interests you, but if not, feel free to contact me about a specific topic!</p>
		<br></br>
		<ul class="list-unstyled"><p>Website Resources:</p>
			<li><p><a href="https://v4-alpha.getbootstrap.com/" target="_blank">Bootstrap 4</a></p></li>
			<li><p><a href="https://www.flaticon.com/" target="_blank">Flaticon</a></p></li>
			<li><p><a href="https://highlightjs.org/" target="_blank">highlight.js</a></p></li>
		</ul>
	</div>
</section>

<section class="toggle" style="display:none;" id="contact-me">
	<div class="container text-center">
		<h4>Have some feedback, questions, or comments? Let me know!</h4>
		<br></br>
		<img src="images/contact-me/email-64.png" class="img-fluid" alt="Email">
		<li><a href="mailto:fintan.t.kelly@gmail.com">fintan.t.kelly@gmail.com</a></li>
		<br></br>
		<img src="images/contact-me/phone-64.png" class="img-fluid" alt="Phone Number">
		<p class="text-white" style="margin-top:10px;">(540)-454-7317</p>
	</div>
</section>

<section class="toggle" style="display:none;" id="java">
	<div class="container text-center">
		<p class="display-4">I'm working on adding tutorials now!</p>
	</div>
</section>

<section class="toggle" style="display:none;" id="jass">
	<div class="container text-center">
		<p class="display-4">I'm working on adding tutorials now!</p>
	</div>
</section>

<section class="toggle" style="display:none;" id="macroquest2">
	<div class="container text-center">
		<div class="card text-white bg-dark mb-3 d-inline-block" style="max-width: 20rem;">
			<div class="card-header"></div>
				<div class="card-body">
					<h4 class="card-title"><a href="#" onclick="toggleSection('mq2-intro');">Macroquest2</a></h4>
					<p class="card-text">I'll move you through using the MQ2Melee plugin and then macros in general. This guide assumes that you know what MQ2 is and have general knowledge of its uses.</p>
				</div>
		</div>
	</div>
</section>

	<section class="toggle" style="display:none;" id="mq2-intro">
		<div class="container text-center">
			<p class="font-weight-bold" style="font-size: 35px">Introduction to Macroquest2</p>
			<div class="row justify-content-center">
				<div class="col">
					<ul class="list-unstyled"><h3>Required Materials:</h3>
						<li><p style="font-size: 20px;"><a href="https://notepad-plus-plus.org/" target="_blank">Notepad++</a></p></li>
						<li><p style="font-size: 20px;"><a href="http://mqemulator.net/downloads.php" target="_blank">MQ2 Program</a></p></li>
						<li><p style="font-size: 20px;"><a href="tutorials/mq2-tutorials/mq2-intro/Xais_Vixenary.ini" target="_blank">MQ2Melee ini Example</a></p></li>
						<li><p style="font-size: 20px;"><a href="tutorials/mq2-tutorials/mq2-intro/AutoKill2.mac" target="_blank">AutoKill2 Macro Example</a></p></li>
					</ul>
				</div>
				<div class="col">
					<ul class="list-unstyled"><h3>Useful Materials:</h3>
						<li><p style="font-size: 20px;"><a href="https://www.macroquest2.com/wiki/index.php/Main_Page" target="_blank">MQ2 Wiki</a></p></li>
						<li><p style="font-size: 20px;"><a href="http://mqemulator.net/forum2/index.php" target="_blank">Helpful MQ2 Forum</a></p></li>
					</ul>
				</div>
				<div class="col">
					<ul class="list-unstyled"><h3>Section Links:</h3>
						<li><p style="font-size: 20px;"><a href="#mq2-intro-section1">Section 1: MQ2Melee</a></p></li>
						<li><p style="font-size: 20px;"><a href="#mq2-intro-section2">Section 2: Macros</a></p></li>
					</ul>
				</div>
			</div>
		</div>
		<br></br>
		<div class="container">
			<h4 class="text-center" id="mq2-intro-section1">Section 1: MQ2Melee</h4>
			<ul class="list-inline text-center">
				<li class="list-inline-item"><p style="font-size: 16px;"><a href="#mq2-intro-section1a">Section 1a: Introduction</a></p></li>||
				<li class="list-inline-item"><p style="margin-left: 4px; font-size: 16px;"><a href="#mq2-intro-section1b">Section 1b: Abilities</a></p></li>||
				<li class="list-inline-item"><p style="margin-left: 4px; font-size: 16px;"><a href="#mq2-intro-section1c">Section 1c: Combat Abilities</a></p></li>||
				<li class="list-inline-item"><p style="margin-left: 4px; font-size: 16px;"><a href="#mq2-intro-section1d">Section 1d: Alt Abilities</a></p></li>||
				<li class="list-inline-item"><p style="margin-left: 4px; font-size: 16px;"><a href="#mq2-intro-section1e">Section 1e: Items</a></p></li>
			</ul>
			<br></br>
			<h4 class="text-center" id="mq2-intro-section1a">Section 1a: Introduction</h4>
			<p>MQ2Melee automation focuses mainly on two elements: holyshits and downshits.</p>
			<p>Holyshits: These run when you are in combat.</p>
			<p>Downshits: These run when you are out of combat.</p>
			<br></br>
			<p>However before we get to these, I want to make sure that you have a .ini file ready to edit. These files have a naming convention:</p>
			<pre><code class="ini">&ltServer Short Name&gt_&ltCharacter Name&gt.ini
Ex: Xais_Vixenary.ini</code></pre>
			<p>You can force MQ2Melee to make a .ini file by typing in &#39/melee save&#39 and will be saved in your main MQ2 folder.</p>
			<p>It will look something like this:</p>
			<pre><code class="ini">[MQ2Melee]
aggro = 1
bash = 1
disarm = 1
enrage = 1
facing = 1
feigndeath = 30
harmtouch = 0
infuriate = 1
kick = 1
melee = 1
petassist = 1
petrange = 75
plugin = 1
provoke1 = 1222
provokeend = 20
provokemax = 1
provokeonce = 1
resume = 75
stickrange = 75
taunt = 1
version = 6.020</code></pre>
			<p>So now that we have a file to edit, let's start working on the holy/downshits. To enable them, we follow the same style as the other elements in the file: </p>
			<pre><code class="ini">downflag&lt0-63&gt = 1
holyflag&lt0-63&gt = 1</code></pre>
			<p></p>
			<p>Make sure that you enable the flag for the corresponding holy/downshit. Here is an example:</p>
			<pre><code class="ini">holyflag0 = 1
holyshit0 = /echo Hello Spam</code></pre>
			<p>Note: This will probably create a lot of spam, so you probably won't want to enter combat with this still active.</p>
			<p></p>
			<p>The next part is probably the hardest because you have access to everything MQ2 can do. I'm going to try and cover some of the common uses and let you take it from there.</p>
			<br></br>
			<h4 class="text-center" id="mq2-intro-section1b">Section 1b: Abilities</h4>
			<img src="tutorials/mq2-tutorials/mq2-intro/eq-actions.png" class="mx-auto d-block img-fluid" alt="EQ Actions Window">
			<br></br>
			<p>What I mean by 'Abilities' is just the regular stuff like Kick, Frenzy, etc. I will let you know that MQ2Melee already has flags for most of this, but I want to show you how to do it yourself.</p>
			<p>Another important note is that there aren't commands like /kick or /frenzy, so we have to compromise and use the Actions window to set our abilities up.</p>
			<p>The commands to use the abilities here are &#39/doability&lt1-6&gt.&#39 So if I wanted to use Intimidation, then I would type &#39/doability 1.&#39</p>
			<p>And since we only want to use this during combat, we'll want to use a holyshit:</p>
			<pre><code class="ini">holyshit0 = /doability 1</code></pre>
			<p>This is just part one complete though. The big problem with it now is that MQ2Melee will continuously try to use the ability even if it's on cooldown. We don't want that, so we need a way to tell it to only use the ability when it's ready. This involves using what's called an if-statement:</p>
			<pre><code class="ini">holyshit0 = /if (${Me.AbilityReady[Intimidation]} /doability 1)</code></pre>
			<p>I won't get into the nitty-gritty details of what exactly happens here, but essentially this if-statement checks to see if Intimidation is ready to use. If it is, then it will use the ability and wait until it's off cooldown again.</p>
			<p></p>
			<p>Now what if we only want to use this ability when the mob is low on hp? Luckily, there are also ways to tell how much health your target has.</p>
			<pre><code class="ini">holyshit0 = /if (${Me.AbilityReady[initmidation]} && (${Target.PctHPs} &lt= 25)) /doability 1</code></pre>
			<p>MQ2Melee will now only use the ability when it's ready and if the target is at, or below, 25% hp.</p>
			<br></br>
			<h4 class="text-center" id="mq2-intro-section1c">Section 1c: Combat Abilities</h4>
			<img src="tutorials/mq2-tutorials/mq2-intro/eq-combatabilities.png" class="mx-auto d-block img-fluid" alt="EQ CAs Window">
			<br></br>
			<p>These are what people typically call Disciplines, or Discs.</p>
			<p>The methodology behind these is very similar to what we just did. For my example, I'll be using the Thousand Blades disc:</p>
			<pre><code class="">/disc Thousand Blades</code></pre>
			<p>This is the command to actually use the disc, but typically we only want to use this when we're fighting a named:</p>
			<pre><code class="ini">holyshit1 = /if (${Me.CombatAbilityReady[Thousand Blades]} && ${Target.Name.Find[#]}) /disc Thousand Blades</code></pre>
			<p>The first part of this if-statement checks to see if the disc is ready to use, much like Intimidation. The second part checks to see if the mob has the &#39#&#39 symbol in his name. This usually indicates a named mob.</p>
			<br></br>
			<h4 class="text-center" id="mq2-intro-section1d">Section 1d: Alt Abilities</h4>
			<img src="tutorials/mq2-tutorials/mq2-intro/eq-altabilities.png" class="mx-auto d-block img-fluid" alt="EQ AAs Window">
			<br></br>
			<p>These are just AAs. These follow essentially the same style as using the discs:</p>
			<pre><code class="ini">holyshit2 = /if (${Me.AltAbilityReady[Boastful Bellow]}) /casting &quotBoastful Bellow&quot alt</code></pre>
			<p>Hopefully this looks pretty familiar. The if-statement checks to see if Boastful Bellow is ready. The command we use after is the new part.</p>
			<p>The /casting command is a feature of the MQ2Cast plugin, and it is much more reliable than the native EQ commands to activate AAs. The &#39alt&#39 at the end tells MQ2Cast that what we're trying to cast is an alt abilitiy.</p>
			<br></br>
			<h4 class="text-center" id="mq2-intro-section1e">Section 1e: Items</h4>
			<img src="tutorials/mq2-tutorials/mq2-intro/eq-items.png" class="mx-auto d-block img-fluid" alt="EQ Items Window">
			<br></br>
			<p>The last aspect I'll focus on here is items. And they follow much the same style as we're used to:</p>
			<pre><code class="ini">holyshit3 = /if (${Cast.Ready[Avner`s Avenging Song]}) /casting &quotAvner`s Avenging Song&quot item</code></pre>
			<p>The main difference here is that instead of looking at &#39Me&#39, we're using &#39Cast.&#39 This lets the MQ2Cast plugin check to see if the item is ready to cast.</p>
			<br></br>
			<p>If you want to see the full example, then I have it at the top of the page as a download link.</p>
			<p>Note: If you're familiar with the /multiline command, then you can use it to string together a bunch of commands for using things like timers.</p>
			<br></br><br></br>
			<h4 class="text-center" id="mq2-intro-section2">Section 2: Macros</h4>
			<p>This section could fill around 100 sections with all the different kinds of things you can do with macros, but for time sake, I’m going to keep it short and look at Xyph’s Autokill2 macro. You can find the macro at the top in the &#39Required Materials&#39 section.</p>
			<p></p>
			<p>I'll try to work you through the macro by splitting it into sections. To give a brief overview of what the macro does, it checks the zone for any mobs to kill, then makes sure it's not on the blackist, then starts warping to it and killing it. It does this until we manually end the macro with &#39/endmacro.&#39</p>
			<br></br>
			<pre><code class="ini">|#event Backstab "You backstab #1# for #2# points of damage."</code></pre>
			<p>This first line at the top references what we call events. Since Xyph actually commented out (denoted by the &#39 | &#39) the event, I won't explain it too much. Essentially what this event checks for is when you've backstabbed something.</p>
			<br></br>
			<pre><code class="ini">sub main</code></pre>
			<p>If you're familiar with programming, this is how we define where the macro starts. If you're not familiar with programming, this is where the magic happens.</p>
			<br></br>
			<pre><code class="ini">/declare longKill timer
/declare curZone string
/declare notValid string
/declare npcID int
/declare i int</code></pre>
			<p>This is you might call the variable initiation section. In short terms, we're creating these variables (curZone, notValid, etc.) that are going to store information we want to remember throughout the macro. I'll explain what each does as we encounter it.</p>
			<br></br>
			<pre><code class="ini">/varset notValid /Norrath`s Keepers Guard/Tatsujiro the Serene/Caridwi/Furious Sentry/The Butler/Velden Dragonbane/Vkjen Thunderslayer/King Tormax/The Avatar of War/a cursed pirate/a sea turtle/Jaques the Infected/a tortured sailor/Smoot/Gordish Frozenheart/Kessdona the Enlightened/Rikkukin the Defender/Gesh`kru/</code></pre>
			<p>This looks really confusing at first, but I promise it's not. This is where we're &quotsetting&quot notValid to hold a bunch of names. We use slashes in between each name so that we can easily tell the macro where each name starts and ends.</p>
			<br></br>
			<pre><code class="ini">/varset curZone ${Zone}</code></pre>
			<p>This line is very similar to the last one. But here we're using what's called a TLO (Top-Level Object) &#39Zone&#39 to give us the name of the zone we're in. Then we're storing that for later use.</p>
			<br></br>
			<pre><code class="ini">:WaitForRespawns</code></pre>
			<p>This is generally what every programmer wants to avoid using: a label. Unfortunately MQ2 doesn't come with native looping functionality other than the basic for-loop. So we can use this as a makeshift while-loop combined with an if-statement afterwards.</p>
			<p>In general terms, this is how keep the macro going without exiting out early on us.</p>
			<br></br>
			<pre><code class="ini">/if (${SpawnCount[npc]}>0) {</code></pre>
			<p>We dealt with this earlier in the MQ2Melee section. It functions exactly the same way as it did before: we're using another TLO here to check the number of NPC spawns in the zone we're in.</p>
			<p>We want to do this to make sure there's something to actually kill when we run the macro.</p>
			<br></br>
			<pre><code class="ini">:NextSpawn</code></pre>
			<p>This is another label that we're using to cycle through each mob in the zone. Once we kill one, the macro will jump back up here and move onto the next.</p>
			<br></br>
			<pre><code class="ini">/if (!${String[${Zone}].Equal[${curZone}]}) /return</code></pre>
			<p>The if-statement here uses the variable we made before (curZone) to check against the zone we're currently in. If they don't match, then we want to stop the macro with &#39/return.&#39</p>
			<br></br>
			<pre><code class="ini">/for i 1 to ${SpawnCount}</code></pre>
			<p>This is the for-loop I mentioned earlier. What's happening here is that we get the number of NPCs in the zone, and then we run the killing part of the macro that many times.</p>
			<p>For example: if there are 10 mobs in the zone, this loop will run 10 times (or more technically, count from 1 to 10).</p>
			<br></br>
			<pre><code class="ini">/vardata npcID NearestSpawn[${i}].ID</code></pre>
			<p>This is how we're finding the ID for the mob we want to kill. The &#39${i}&#39 is how we reference what number the loop is on, and this is what lets us go down the list.</p>
			<br></br>
			<pre><code class="ini">/if ((${npcID}!=${Me.ID}) && (${Spawn[${npcID}].Type.Equal[NPC]})) {</code></pre>
			<p>The if-statement here is a logic check: we don't want the macro to target ourselves for obvious reasons, and we want to make sure that our intended target is a NPC we can kill.</p>
			<br></br>
			<pre><code class="ini">/if ((${notValid.Find[/${Spawn[${npcID}].CleanName}/]}==NULL) && (${Spawn[${npcID}].CleanName.Length}>0)) {</code></pre>
			<p>It seems like Xyph split this check into two chunks to make it easier to understand. The purpose of this if-statement is to make sure our mob's name isn't on our blacklist and that its name is at least 1 character long.</p>
			<p>The reason for checking this is because unkillable mobs typically have an empty name.</p>
			<br></br>
			<pre><code class="ini">/target id ${npcID}</code></pre>
			<p>This is a simple slash command that MQ2 has to target a NPC based on its ID. And we stored that ID in &#39npcID&#39 earlier before the two if-statement checks.</p>
			<br></br>
			<pre><code class="ini">/if (!${longKill}) {
	/call warpTarget 0
} else {
	/call warpTarget 1
}</code></pre>
			<p>We haven't quite gotten to the point where we set our timer &#39longKill,&#39 but if we haven't killed the mob in a certain period of time, then it most likely means we can't hit it. So we'll want to warp to him again.</p>
			<p>We use this &#39/call warpTarget&#39 function at the end of the macro to actually warp to the mob. The &#39 0 &#39 or &#39 1 &#39 tells the macro whether we need to give some distance between the mob and ourselves.</p>
			<br></br>
			<pre><code class="ini">:Retarget

/target clear
/delay 5
/target id ${npcID}
/delay 1s ${Target.Distance}<10
/stick 7 moveback
/attack on

/varset longKill 8s</code></pre>
			<p>This section is where we start attacking the mob after we warp to it. The reason we clear our target at first is because EQ has a bug where you can't interact with a NPC you targeted from too far away. Then we stick to the mob and turn our attack on.</p>
			<br></br>
			<pre><code class="ini">:WaitForDead

/face fast nolook</code></pre>
			<p>We're using this label here to tell the macro to wait until we kill the mob. The &#39/face fast nolook&#39 command makes your character face the mob so you have a clear line of sight.</p>
			<br></br>
			<pre><code class="ini">/doevents</code></pre>
			<p>This command relates to the commented out event we saw earlier. This tells MQ2 to execute any events that have queued up. There's usually a &#39sub&#39 or function to go with each event, but since it was commented out in this macro, there isn't one to reference, so nothing happens.</p>
			<br></br>
			<pre><code class="ini">/if (${String[${Me.Class}].Equal[Rogue]}) {
	/if (${Me.AbilityReady[Backstab]}) /doability Backstab
	/if (${String[${Me.Song[Thief's Eyes]}].Equal[NULL]}) /doability &quotThief&#39s Eyes&quot
}</code></pre>
			<p>This is a specialized part of the macro that only occurs if you're a Rogue. In the case that you are, the macro will use your Backstab for you and then Thief's Eyes.</p>
			<p>Hopefully this looks familiar from the MQ2Melee section.</p>
			<br></br>
			<pre><code class="ini">/if (${String[${Me.Class}].Equal[Druid]}) {
	/casting &quotGalatine&quot
	/delay 4
}</code></pre>
			<p>This is another specialized section that checks to see if you're a Druid. If so, then it will cast Galatine for you.</p>
			<br></br>
			<pre><code class="ini">/if ((${Target.Type.Equal[CORPSE]}) || (!${longKill})) /target clear</code></pre>
			<p>This is the part of the macro that checks to see if we need to move on to the next mob. If the one we're currently fighting is dead or our fighting timer has run out, then clear the target and find the nearest mob.</p>
			<br></br>
			<pre><code class="ini">/if (${Target.Distance}>50) /call warpTarget 0</code></pre>
			<p>This is another check to make sure the mob hasn't warped or somehow gotten away from us. If it has, then we want to warp to it.</p>
			<br></br>
			<pre><code class="ini">/if (${Target.ID}==${npcID}) /goto :WaitForDead</code></pre>
			<p>Here we want to make sure that we're not leaving the mob we're fighting alive. If our current target's ID matches the ID we saved at the beginning of the loop, then keep killing it.</p>
			<p>The &#39/goto&#39 command is how we navigate to labels directly.</p>
			<br></br>
			<pre><code class="ini">/goto :NextSpawn</code></pre>
			<p>This macro doesn't use any conditional checks to go to the top of the macro, so this serves as a constant label jump so the macro keeps running until no mobs are alive.</p>
			<br></br>
			<pre><code class="ini">/next i</code></pre>
			<p>This just increments the for-loop to go from one number to the next.</p>
			<br></br>
			<pre><code class="ini">/delay 5s

/goto :WaitForRespawns</code></pre>
			<p>This delay command here lets the macro sleep for a few seconds to try and wait for some mobs to repop. Once it's waited 5 seconds, it will go to the top of the macro and check for mobs again.</p>
			<br></br>
			<pre><code class="ini">/return</code></pre>
			<p>This is how we tell macros to close out, but since we want this macro to run until we manually stop it, the &#39/goto&#39 command prevents the macro from reaching the return.</p>
			<br></br>
			<pre><code class="ini">sub warpTarget(boolWithDistance)
	/if (${boolWithDistance}) {
		/warp loc ${Math.Calc[${Target.Y}-2]} ${Math.Calc[${Target.X}-2]} ${Target.Z}
	} else {
		/warp target
	}
/return</code></pre>
			<p>This is what some people might call a helper function (or in our case a helper sub). It's called this because we use it to separate some commands or calculations we do multiple times into one function we can easily call in the main part of the macro.</p>
			<p>To explain what it does, it's looking for a &#39 0 &#39 or a &#39 1 &#39 indicating a &#39no&#39 or a &#39yes.&#39 With that, it will either warp you to the mob with a little distance in between you (if given &#39yes&#39) or warp you right on top of the mob (if given &#39no&#39).</p>
			<br></br><br></br>
			<h4 class="text-center">Conclusion</h4>
			<p></p>
			<p>So that's my small rundown of MQ2Melee and an example macro. Hopefully you're able to better understand the intent behind some of the decisions made when making MQ2Melee holy/downshits and the methodology behind the macro.</p>
			<p>There's an extensive amount of TLOs you can use to pull in various amounts of information to make some really interesting macros. I'll probably cover some specific ones that are very helpful in most macros in a different tutorial.</p>
			<p>There's a list of useful resources at the top of the page if you'd like to look at the wiki for the different TLOs or learn more.</p>
			<p>If you have any questions, feel free to contact me!</p>
		</div>
		<br></br>
	</section>

<section class="toggle" style="display:none;" id="writing">
	<div class="container text-center">
		<p class="display-4">I'm working on adding tutorials now!</p>
	</div>
</section>
</body>
</html>